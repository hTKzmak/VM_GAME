var t=Object.defineProperty,e=(e,s,i)=>((e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i)(e,"symbol"!=typeof s?s+"":s,i);import{p as s}from"./phaser-DM0uoNMb.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class i extends s.Scene{constructor(){super("Boot")}preload(){}create(){this.scene.start("Preloader")}}class o extends s.Scene{constructor(){super("GameOver"),e(this,"camera"),e(this,"gameover_text")}create(){document.title="A Game by Melnik",console.log("A Game by Melnik (https://github.com/hTKzmak)"),this.camera=this.cameras.main,this.camera.setBackgroundColor("#000000"),this.gameover_text=this.add.text(230,50,"This program has exited",{fontFamily:"PIXY",fontSize:28,color:"#d4d4d490",align:"center"}),this.gameover_text.setOrigin(.5)}}class r extends s.Scene{constructor(){super("MainMenu"),e(this,"camera"),e(this,"text")}create(){document.title="Press Enter",this.camera=this.cameras.main,this.camera.setBackgroundColor("#d4d4d4"),this.text=this.add.text(300,600,"Press Enter",{fontFamily:"PIXY",fontSize:38,color:"#222222",align:"center"}),this.text.setOrigin(.5),this.input.keyboard.on("keydown-ENTER",(()=>{this.scene.stop(),setTimeout((()=>{this.scene.start("MindOne")}),1e3)}))}}const h=49,a=60,n=24,l=24,d=32,c=52,p=18,u=23,y="Player",m="Door",f="Button",g="Pet";class x extends s.Physics.Arcade.Sprite{constructor(t,e,s,i,o){super(t,e,s,i),this.scene=t,this.scene.add.existing(this),this.scene.physics.add.existing(this)}}const w=[{entity:"Pet",dialogues:["Keep you waiting, huh?","Although time doesn't matter here."]},{entity:"Door",dialogues:["Looks like some kind of way out.","There's hardly anything else to see here.","Is it worth leaving here?"]},{entity:"Button",dialogues:["Press this button?"]},{entity:"Bubbles",dialogues:["Looks like some bubbles.","But why they are dark?"]},{entity:"smth",dialogues:["???"]}];class k{constructor(t,s,i,o,r){e(this,"onComplete"),e(this,"scene"),e(this,"graphics"),e(this,"text"),e(this,"dialogue"),e(this,"allDialogues"),e(this,"currentCharIndex"),e(this,"currentDialogIndex"),e(this,"isComplete"),e(this,"textTimer"),e(this,"sound"),e(this,"player"),this.scene=t,this.sound=i,this.currentCharIndex=0,this.currentDialogIndex=0,this.allDialogues=s,this.dialogue=s[this.currentDialogIndex],this.isComplete=!1,this.player=o,this.onComplete=r,this.graphics=t.add.graphics(),this.graphics.lineStyle(10,15263976,1),this.graphics.strokeRect(45,495,940,240),this.graphics.fillStyle(2236962,1),this.graphics.fillRect(50,500,930,230),this.graphics.setScrollFactor(0),this.text=t.add.text(90,530,"",{fontFamily:"PIXY",fontSize:"26px",color:"#ffffff",wordWrap:{width:600}}),this.startTyping(),this.text.setScrollFactor(0),t.input.keyboard.on("keydown-ENTER",this.skipOrNext,this)}startTyping(){this.player.notTalking=!1,this.textTimer=this.scene.time.addEvent({delay:30,callback:this.typeText,callbackScope:this,loop:!0})}typeText(){this.isComplete||(this.text.text+=this.dialogue[this.currentCharIndex],this.currentCharIndex++,this.sound.play(),this.currentCharIndex>=this.dialogue.length&&(this.textTimer.remove(!1),this.isComplete=!0))}skipOrNext(){this.isComplete?this.currentDialogIndex<this.allDialogues.length-1?(this.currentDialogIndex++,this.dialogue=this.allDialogues[this.currentDialogIndex],this.currentCharIndex=0,this.isComplete=!1,this.text.text="",this.player.notTalking=!1,this.startTyping()):this.close():(this.text.text=this.dialogue,this.textTimer.remove(!1),this.isComplete=!0,this.player.notTalking=!1)}close(){this.graphics.destroy(),this.text.destroy(),this.scene.input.keyboard.off("keydown-ENTER",this.skipOrNext,this),this.player.notTalking=!0,this.onComplete&&this.onComplete()}}class b{constructor(t,s,i){e(this,"onComplete"),e(this,"scene"),e(this,"graphics"),e(this,"yesText"),e(this,"noText"),e(this,"player"),e(this,"startOnComplete"),this.scene=t,this.player=s,this.player.notTalking=!1,this.startOnComplete=!0,this.onComplete=i,this.graphics=t.add.graphics(),this.graphics.lineStyle(10,15263976,1),this.graphics.strokeRect(45,495,940,240),this.graphics.fillStyle(2236962,1),this.graphics.fillRect(50,500,930,230),this.graphics.setScrollFactor(0),this.yesText=t.add.text(370,580,"Yes",{fontFamily:"PIXY",fontSize:"42px",color:"#ffffff",wordWrap:{width:600}}),this.noText=t.add.text(570,580,"No",{fontFamily:"PIXY",fontSize:"42px",color:"#ffffff7d",wordWrap:{width:600}}),this.yesText.setScrollFactor(0),this.noText.setScrollFactor(0),t.input.keyboard.on("keydown-A",this.chooseYes,this),t.input.keyboard.on("keydown-D",this.chooseNo,this),t.input.keyboard.on("keydown-LEFT",this.chooseYes,this),t.input.keyboard.on("keydown-RIGHT",this.chooseNo,this),t.input.keyboard.on("keydown-ENTER",this.close,this)}chooseYes(){this.yesText.setColor("#ffffff"),this.noText.setColor("#ffffff7d"),this.startOnComplete=!0}chooseNo(){this.noText.setColor("#ffffff"),this.yesText.setColor("#ffffff7d"),this.startOnComplete=!1}close(){this.graphics&&this.graphics.destroy(),this.yesText&&this.yesText.destroy(),this.noText&&this.noText.destroy(),this.scene.input.keyboard.off("keydown-A",this.chooseYes,this),this.scene.input.keyboard.off("keydown-D",this.chooseNo,this),this.scene.input.keyboard.off("keydown-LEFT",this.chooseYes,this),this.scene.input.keyboard.off("keydown-RIGHT",this.chooseNo,this),this.scene.input.keyboard.off("keydown-ENTER",this.close,this),this.player.notTalking=!0,this.onComplete&&!0===this.startOnComplete&&this.onComplete()}}class T extends x{constructor(t,s,i,o,r,h){super(t,s,i,o,y),e(this,"textureKey"),e(this,"entities"),e(this,"moveSpeed"),e(this,"notTalking"),e(this,"sound");const a=this.scene.anims;this.textureKey=o,this.moveSpeed=23,this.notTalking=!0,this.sound=r,this.setSize(28,50),this.setOffset(10,5),a.create({key:"up",frames:a.generateFrameNumbers(this.textureKey,{frames:[7,8,9,8]}),frameRate:4,repeat:-1}),a.create({key:"down",frames:a.generateFrameNumbers(this.textureKey,{frames:[5,0,6,0]}),frameRate:4,repeat:-1}),a.create({key:"left",frames:a.generateFrameNumbers(this.textureKey,{start:1,end:2}),frameRate:4,repeat:-1}),a.create({key:"right",frames:a.generateFrameNumbers(this.textureKey,{start:3,end:4}),frameRate:4,repeat:-1})}setEntities(t){this.entities=t}findTarget(t){let e=null,s=50;for(const i of t){const t=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);t<s&&(s=t,e=i)}return e}update(t){const e=this.scene.input.keyboard.createCursorKeys();let s=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W),i=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),o=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),r=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D),h=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.E);if((e.up.isDown||s.isDown)&&this.notTalking)this.play("up",!0),this.setVelocity(0,-15*this.moveSpeed);else if((e.down.isDown||o.isDown)&&this.notTalking)this.play("down",!0),this.setVelocity(0,15*this.moveSpeed);else if((e.left.isDown||i.isDown)&&this.notTalking)this.play("left",!0),this.setVelocity(-15*this.moveSpeed,0);else if((e.right.isDown||r.isDown)&&this.notTalking)this.play("right",!0),this.setVelocity(15*this.moveSpeed,0);else if(Phaser.Input.Keyboard.JustDown(h)&&this.notTalking){const t=this.findTarget(this.entities);if(t){const e=w.find((e=>e.entity===t.textureKey));"Door"==t.textureKey||"Button"==t.textureKey?new k(this.scene,e.dialogues,this.sound,this,(()=>{new b(this.scene,this,(()=>{t.interact()}))})):e&&new k(this.scene,e.dialogues,this.sound,this,null)}}else this.stop(),this.setVelocity(0,0)}}class S extends x{constructor(t,s,i,o,r){super(t,s,i,o,g),e(this,"textureKey"),e(this,"player");const h=this.scene.anims;this.textureKey=o,this.setSize(26,26),this.setOffset(0,0),h.create({key:"calm",frames:h.generateFrameNames(this.textureKey,{frames:[0,1,2,3,2,1,0]}),frameRate:3,repeat:-1}),this.play("calm",!0)}setPlayer(t){this.player=t}}class C extends s.Physics.Arcade.Sprite{constructor(t,e,s,i,o){super(t,e,s,i),this.scene=t,this.scene.add.existing(this),this.scene.physics.add.existing(this)}}class M extends C{constructor(t,s,i,o,r){super(t,s,i,o,m),e(this,"textureKey"),e(this,"player"),this.textureKey=o,this.setSize(32,20),this.setOffset(0,0)}setPlayer(t){this.player=t}interact(){this.player&&this.scene.shutdownScene()}}class v extends s.Scene{constructor(){super("MindOne"),e(this,"camera"),e(this,"dialogueSound"),e(this,"player"),e(this,"pet"),e(this,"door"),e(this,"intro"),e(this,"VM001_BG_Music")}create(){document.title="VM001",this.intro=this.add.video(512,384,"intro_video").setOrigin(.5,.5),this.intro.setScrollFactor(0),this.intro.setDepth(1),this.intro.play(),this.VM001_BG_Music=this.sound.add("VM001_BG_Music",{loop:!0}),this.VM001_BG_Music.play();const t=this.sound.add("dialogueSound");this.intro.on("complete",(()=>{this.tweens.add({targets:this.intro,alpha:0,duration:1e3,ease:"Linear",onComplete:()=>{this.intro.destroy()}}),this.door=new M(this,2e3,300,m),this.player=new T(this,1300,1e3,y,t),this.pet=new S(this,1e3,1300,g),this.camera=this.cameras.main,this.camera.setBackgroundColor("#d4d4d4"),this.cameras.main.startFollow(this.player),this.cameras.main.setBounds(0,0,2500,2500),this.physics.world.setBounds(0,0,2500,2500),this.player.setCollideWorldBounds(!0),this.pet.setPlayer(this.player),this.door.setPlayer(this.player),this.player.setEntities([this.pet,this.door]),this.physics.add.collider(this.player,this.pet),this.physics.add.collider(this.player,this.door),this.pet.setImmovable(!0),this.door.setImmovable(!0)}))}shutdownScene(){this.player.notTalking=!1,this.tweens.add({targets:this.player,alpha:0,duration:1300,ease:"Linear",onComplete:()=>{setTimeout((()=>{this.VM001_BG_Music.stop(),this.scene.stop(),setTimeout((()=>{this.scene.start("MindTwo")}),1e3)}),1e3)}})}update(t,e){!this.intro.isPlaying()&&this.player&&this.player.update(e)}}class P extends C{constructor(t,s,i,o,r){super(t,s,i,o,f),e(this,"textureKey"),e(this,"player"),this.textureKey=o,this.setSize(18,20),this.displayWidth=32,this.displayHeight=42,this.setOffset(0,0)}setPlayer(t){this.player=t}interact(){this.player&&this.scene.shutdownScene()}}class K{constructor(t,s){e(this,"world"),e(this,"emitter"),e(this,"sprite"),this.world=t,this.sprite=s,this.emitter=this.world.add.particles(0,0,this.sprite,{x:{min:0,max:this.world.scale.width+100},y:0,lifespan:2500,speedY:{min:300,max:500},speedX:-70,scale:1,quantity:1,blendMode:"ADD",rotate:-25,frequency:100,emitting:!1}),this.emitter.setScrollFactor(0)}playRain(){this.emitter.start()}removeRain(){this.emitter.stop()}}class _{constructor(t,s,i){e(this,"emitter"),e(this,"sprite"),e(this,"world"),e(this,"player"),this.world=t,this.sprite=s,this.player=i,this.emitter=this.world.add.particles(0,0,this.sprite,{lifespan:400,scale:{start:2,end:4},alpha:{start:1,end:0},emitting:!1,frequency:300}),this.emitter.startFollow(this.player,this.player.width-50,this.player.height-40,!0),this.emitter.setDepth(-1)}playRipple(){this.emitter.start()}removeRipple(){this.emitter.stop()}}class I extends s.Scene{constructor(){super("MindTwo"),e(this,"dialogueSound"),e(this,"camera"),e(this,"errorSound"),e(this,"player"),e(this,"button"),e(this,"ripple"),e(this,"mindtwo"),e(this,"VM002_BG_Music")}create(){document.title="VM002",this.mindtwo=this.add.video(512,384,"mindtwo_video").setOrigin(.5,.5),this.mindtwo.setScrollFactor(0),this.mindtwo.setDepth(1),this.mindtwo.play(),this.VM002_BG_Music=this.sound.add("VM002_BG_Music",{loop:!0}),this.VM002_BG_Music.play();const t=this.sound.add("dialogueSound");this.mindtwo.on("complete",(()=>{this.tweens.add({targets:this.mindtwo,alpha:0,duration:1e3,ease:"Linear",onComplete:()=>{this.mindtwo.destroy()}}),this.player=new T(this,1e3,500,y,t),this.button=new P(this,1e3,1900,f),this.player.setEntities([this.button]),this.button.setPlayer(this.player),this.physics.world.setBounds(0,0,2e3,3e3),this.player.setCollideWorldBounds(!0),this.physics.add.collider(this.player,this.button),this.button.setImmovable(!0),this.cameras.main.startFollow(this.player),this.cameras.main.setBounds(0,0,2e3,3e3),new K(this,"rain").playRain(),this.ripple=new _(this,"ripple",this.player)}))}shutdownScene(){this.errorSound=this.sound.add("errorSound",{loop:!0}),this.errorSound.play(),this.VM002_BG_Music.stop(),this.scene.pause(),setTimeout((()=>{this.errorSound.pause(),this.scene.start("GameOver")}),3e3)}update(t,e){!this.mindtwo.isPlaying()&&this.player&&(this.player.update(e),0!==this.player.body.velocity.x||0!==this.player.body.velocity.y?this.ripple.playRipple():this.ripple.removeRipple())}}class D extends s.Scene{constructor(){super("Preloader")}init(){}preload(){this.load.audio("errorSound","assets/sounds/error.mp3"),this.load.audio("dialogueSound","assets/sounds/retro_single_v3.mp3"),this.load.audio("VM001_BG_Music","assets/music/deepMines.mp3"),this.load.audio("VM002_BG_Music","assets/music/countdown.mp3"),this.load.video("intro_video","assets/video/intro.mp4"),this.load.video("mindtwo_video","assets/video/mindtwo.mp4"),this.load.spritesheet(y,"assets/sprites/hero.png",{frameWidth:h,frameHeight:a}),this.load.spritesheet(g,"assets/sprites/pet.png",{frameWidth:n,frameHeight:l}),this.load.spritesheet(m,"assets/sprites/door.png",{frameWidth:d,frameHeight:c}),this.load.spritesheet(f,"assets/sprites/button.png",{frameWidth:p,frameHeight:u}),this.load.image("rain","assets/sprites/rain.png"),this.load.image("ripple","assets/sprites/ripple.png"),this.load.font("pixy","assets/fonts/PIXY.ttf")}create(){this.scene.start("MainMenu")}}const B={type:Phaser.AUTO,width:1024,height:768,parent:"game-container",backgroundColor:"#000000",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{debug:!1}},scene:[i,D,r,v,I,o]};new s.Game(B);
